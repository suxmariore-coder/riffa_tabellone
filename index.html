<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tabella Interattiva 1-90</title>
<style>
  body {
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 10px;
    background-color: #f9f9f9;
  }

  h2 {
    margin-bottom: 10px;
    text-align: center;
  }

  .status {
    margin-bottom: 15px;
    font-size: 16px;
    font-weight: bold;
    text-align: center;
  }

  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(50px, 1fr));
    gap: 6px;
    width: 100%;
    max-width: 700px;
  }

  .number {
    aspect-ratio: 1 / 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    border-radius: 8px;
    cursor: pointer;
    user-select: none;
    background-color: #4CAF50;
    color: white;
    font-size: 16px;
    font-weight: bold;
    transition: background-color 0.3s, transform 0.2s;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    text-align: center;
  }

  .number:hover {
    transform: scale(1.05);
  }

  .number.purchased {
    background-color: #f44336;
    cursor: default;
  }

  .name {
    font-size: 10px;
    font-weight: normal;
    margin-top: 3px;
    word-break: break-word;
    text-align: center;
  }

  /* Popup overlay */
  .popup-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    padding: 10px;
  }

  .popup {
    background: white;
    padding: 15px;
    border-radius: 10px;
    width: 100%;
    max-width: 320px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
  }

  .popup input, .popup select, .popup button {
    width: 100%;
    margin: 8px 0;
    padding: 8px;
    font-size: 14px;
  }

  .popup button {
    background-color: #4CAF50;
    color: white;
    border: none;
    cursor: pointer;
    font-weight: bold;
  }

  .popup button:hover {
    background-color: #45a049;
  }

  /* Media query per schermi molto piccoli */
  @media (max-width: 400px) {
    .number {
      font-size: 14px;
    }
    .name {
      font-size: 9px;
    }
    .popup {
      padding: 12px;
    }
  }
</style>
</head>
<body>

<h2>Tabella Interattiva 1-90</h2>
<div class="status" id="status">
  Numeri disponibili: 90 | Numeri acquistati: 0
</div>

<div class="grid" id="numberGrid"></div>

<!-- Popup per inserimento dati -->
<div class="popup-overlay" id="popupOverlay">
  <div class="popup">
    <h3>Acquista Numero <span id="popupNumber"></span></h3>
    <input type="text" id="popupName" placeholder="Inserisci il tuo nome">
    <select id="popupPayment">
      <option value="">Seleziona metodo pagamento</option>
      <option value="paypal">PayPal</option>
      <option value="revolut">Revolut</option>
    </select>
    <button id="popupConfirm">Conferma</button>
    <button id="popupCancel" style="background-color: #f44336; margin-top: 5px;">Annulla</button>
  </div>
</div>

<script>
const grid = document.getElementById('numberGrid');
const status = document.getElementById('status');
const popupOverlay = document.getElementById('popupOverlay');
const popupNumber = document.getElementById('popupNumber');
const popupName = document.getElementById('popupName');
const popupPayment = document.getElementById('popupPayment');
const popupConfirm = document.getElementById('popupConfirm');
const popupCancel = document.getElementById('popupCancel');

let availableCount = 90;
let purchasedCount = 0;
let selectedNumberDiv = null;
let selectedNumber = null;

function updateStatus() {
  status.textContent = `Numeri disponibili: ${availableCount} | Numeri acquistati: ${purchasedCount}`;
}

// Crea numeri
for (let i = 1; i <= 90; i++) {
  const numberDiv = document.createElement('div');
  numberDiv.classList.add('number');

  const numberSpan = document.createElement('span');
  numberSpan.textContent = i;
  numberDiv.appendChild(numberSpan);

  const nameSpan = document.createElement('span');
  nameSpan.classList.add('name');
  numberDiv.appendChild(nameSpan);

  numberDiv.addEventListener('click', () => {
    if (!numberDiv.classList.contains('purchased')) {
      selectedNumberDiv = numberDiv;
      selectedNumber = i;
      popupNumber.textContent = i;
      popupName.value = "";
      popupPayment.value = "";
      popupOverlay.style.display = 'flex';
    }
  });

  grid.appendChild(numberDiv);
}

// Popup conferma acquisto
popupConfirm.addEventListener('click', () => {
  const name = popupName.value.trim();
  const payment = popupPayment.value;

  if (!name || !payment) {
    alert("Compila tutti i campi!");
    return;
  }

  popupOverlay.style.display = 'none';

  if (payment === "paypal") {
    const paypalLink = "https://www.paypal.me/reimar2002/2"; // minimo 2â‚¬
    window.open(paypalLink, "_blank");

    setTimeout(() => {
      markNumberPurchased(selectedNumberDiv, name);
    }, 5000);

  } else if (payment === "revolut") {
    const revolutLink = "https://revolut.me/marioreita";
    window.open(revolutLink, "_blank");

    setTimeout(() => {
      markNumberPurchased(selectedNumberDiv, name);
    }, 5000);
  }
});

// Annulla popup
popupCancel.addEventListener('click', () => {
  popupOverlay.style.display = 'none';
});

function markNumberPurchased(numberDiv, name) {
  numberDiv.classList.add('purchased');
  numberDiv.querySelector('.name').textContent = name;
  availableCount--;
  purchasedCount++;
  updateStatus();
}

updateStatus();
</script>

</body>
</html>
